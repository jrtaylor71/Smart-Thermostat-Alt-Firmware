; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:esp32-s3-wroom-1-n16]
platform = espressif32@^6.6.0
board = esp32-s3-thermostat
board_build.mcu = esp32s3
board_build.flash_size = 16MB
board_build.partitions = default_16mb.csv
framework = arduino
; Custom board configuration for ESP32-S3-WROOM-1-N16 (16MB Flash, No PSRAM)
; Based on smart-thermostat project configuration
lib_deps = 
	WiFi
	Preferences
	adafruit/Adafruit AHTX0@^2.0.5
	adafruit/Adafruit Unified Sensor@^1.1.15
	paulstoffregen/OneWire@^2.3.7
	milesburton/DallasTemperature@^4.0.5
	bodmer/TFT_eSPI@^2.5.43
    esp32async/AsyncTCP@^3.4.9
    esp32async/ESPAsyncWebServer@^3.9.2
	knolleary/PubSubClient@^2.8
	bblanchon/ArduinoJson@^7.4.2
	iavorvel/MyLD2410@^1.2.5

lib_ignore = 
	AsyncTCP_RP2040W
monitor_speed = 115200
; Use USB-Serial/JTAG for upload, diagnostic UART for monitoring
monitor_port = /dev/ttyUSB0
upload_port = /dev/ttyACM0

; Prevent parallel build race conditions
build_jobs = 1

build_flags = 
    -w
    -Wno-unused-variable
    -Wno-unused-function
    -Wno-unused-but-set-variable
    -Wno-sign-compare
    ; Custom TFT_eSPI configuration for ESP32-S3 Smart Thermostat
    ; Using smart-thermostat pin layout (backlight confirmed on GPIO14)
    -DUSER_SETUP_LOADED=1
    -DILI9341_DRIVER=1
    -DUSE_HSPI_PORT=1
    -DTFT_MISO=21
    -DTFT_MOSI=12
    -DTFT_SCLK=13
    -DTFT_CS=9
    -DTFT_DC=11
    -DTFT_RST=10
    -DTFT_BL=14
    ; Touch pins from schematic
    -DTOUCH_CS=47
    -DTOUCH_IRQ=48
    -DLOAD_GLCD=1
    -DLOAD_FONT2=1
    -DLOAD_FONT4=1
    -DLOAD_FONT6=1
    -DLOAD_FONT7=1
    -DLOAD_FONT8=1
    -DLOAD_GFXFF=1
    -DSMOOTH_FONT=1
    -DSPI_FREQUENCY=27000000
    -DSPI_READ_FREQUENCY=6000000
    -DSPI_TOUCH_FREQUENCY=2500000

; Suppress warnings from WebResponses.cpp.o
build_unflags = 
    -Wall
    -Wextra

